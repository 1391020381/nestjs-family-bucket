# mongodb 数据不丢失是怎么保证

1. 副本集与数据冗余

- 副本集是MongoDB 高可用和数据安全的基础。它通常由一个主节点和多个从节点组成。
  - 数据同步
    - 所有写操作都发生在主节点上,然后这些操作会异步地复制到从节点。 这意味着你的数据会同时存在于多个节点上,形成一个数据副本。即使某个节点发生故障,其他节点仍然保有完整数据。
  - 自动故障转移
    - 当主节点宕机时,副本集会自动触发选举机制,从健康的从节点中选举新的主节点以继续提供服务。 这个过程是自动的,有效减少了服务中断时间并保障了数据可用性。
  - Journaling: 持久化引擎
    - Journaling是MongoDB的预写日志机制,默认启用。
    - 工作原理: 在将数据修改应用到内存和最终的数据库文件之前,MongoDB会将写操作记录到Journal日志文件中
    - 崩溃恢复: 如果发生服务器意外断电或崩溃,在重启时,MongoDB会使用Journal日志来重放那些尚未完全写入数据文件的操作,从而将数据库恢复到崩溃前的一致状态。 这确保了即使在最糟糕的情况下,已经确认的写操作也不会丢失。
  - 写入语义:控制数据确认
