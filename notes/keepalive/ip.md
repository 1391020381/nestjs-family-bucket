- 公网IP
- 内网IP
- 虚拟ip
  - 虚拟IP通常是公网或内网IP的一种"逻辑表现",它可以是公网IP,也可以是内网IP，取决于部署环境
  - 作为对外统一的访问入口
  - 在多台服务器之间共享或漂移
  - 用于 负载均衡 高可用 故障切换等场景
  - 本质上是一个 可移动的IP地址，可以飘到不同的物理服务器上,但对外始终表现为同一个IP 从而保证服务的连续性和可访问性

# 虚拟IP是怎么生成的?

- 虚拟IP 并不是 '生成出来的新IP地址' 而是 配置/绑定 到某个网络接口(或逻辑接口)上的一个已有的IP地址。
  - 虚拟IP是从已有IP地址段中选取的
  - 虚拟IP本身并不属于某一台具体机器，而是由软件层面控制其存在的哪台机器上。
- 虚拟IP 配置/绑定过程
  - Keepalived
  - Nginx proxy
  - 云平台 提供弹性公网IP 可以绑定/解绑到不同的实例,起到类似VIP作用

# 虚拟IP保证可访问

1. VIP可以在服务器间漂移(Failover)

   - VRRP协议 (Virtual Router Redundancy Protocol)
   - Keepalived 就是基于 VRRP实现的
   - 多台服务器组成一个组(比如两台服务器A和B) 都监听同一VIP
   - 正常情况下,其中一台(Master)持有VIP并响应请求
   - 如果Master宕机,Backup服务器会自动检测到,并接管VIP(即VIP漂移)
   - 整个过程对用户透明,用户仍然访问同一个IP 服务不中断。

   - 这就是高可用 的核心原理之一。

2. 负载均衡器 使用 VIP作为统一入口
   - 在负载均衡场景中(Nginx)
   - VIP是用户访问的统一入口IP
   - 负载均衡器监听这个VIP，将请求按照规则(轮询 权重 最小连接等) 分发给后端的多个真实服务器(Real Servers)
   - 后端服务器通常使用内网IP 不直接暴露在公网
   - VIP可以是负载均衡器自身的公网/内网IP,也可以是一个专门的虚拟IP
